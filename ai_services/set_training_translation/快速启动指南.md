# 🤟 手语翻译系统 - 快速启动指南

> 本项目实现了**数据集生成**、**模型训练**、**实时手语翻译**三大核心功能，支持自定义手语词汇的端到端识别。

---

## 📋 目录

- [环境准备](#环境准备)
- [1️⃣ 数据集生成](#1️⃣-数据集生成)
- [2️⃣ 模型训练](#2️⃣-模型训练)
- [3️⃣ 实时翻译](#3️⃣-实时翻译)
- [常见问题](#常见问题)
- [性能优化建议](#性能优化建议)

---

## 环境准备

### 系统要求

- **操作系统**: Windows 10/11, macOS, Linux
- **Python**: 3.8 或以上版本
- **浏览器**: Chrome, Edge, Firefox (需支持摄像头访问)
- **摄像头**: 用于数据采集和实时翻译

### 安装依赖

#### 方法一：使用虚拟环境（推荐）

```powershell
# 1. 创建虚拟环境
python -m venv venv

# 2. 激活虚拟环境
# Windows PowerShell:
.\venv\Scripts\Activate.ps1

# Windows CMD:
.\venv\Scripts\activate.bat

# macOS/Linux:
source venv/bin/activate

# 3. 安装依赖包
pip install -r requirements.txt
```

#### 方法二：直接安装

```bash
pip install -r requirements.txt
```

#### 依赖包列表 (`requirements.txt`)

```txt
tensorflow==2.15.0
mediapipe==0.10.9
opencv-python==4.8.1.78
numpy==1.26.4
flask==3.0.0
flask-cors==4.0.0
pillow==10.1.0
scikit-learn==1.3.2
protobuf==3.20.3
jax==0.4.13
jaxlib==0.4.13
```

---

## 1️⃣ 数据集生成

### 步骤说明

1. **启动数据采集页面**

   在浏览器中打开：

   ```
   http://127.0.0.1:5000/data_collection.html
   ```

   或直接打开本地文件：

   ```
   双击打开: data_collection.html
   ```

2. **配置采集参数**

   - **单词名称**: 输入手语对应的单词（支持任何语言）
     - 示例：`hello`, `thank`, `goodbye`, `yes`, `no`
   - **拍摄数量**: 建议设置为 **60-100** 张
     - ⚠️ **重要**: 数量是关键！这是从 50% 准确率到 100% 准确率飞跃的关键因素

3. **拍摄手语图片**

   - 点击 **"启动摄像头"** 按钮
   - 调整手势位置，确保手部清晰可见
   - 点击 **"开始连拍"** 按钮
   - 在连拍过程中：
     - ✅ 保持基本动作一致
     - ✅ 适当变换角度（±15°）
     - ✅ 改变手的位置（上下左右微调）
     - ✅ 如有条件，更换不同光照环境

4. **下载数据集**

   - 完成拍摄后，点击 **"下载数据集"** 按钮
   - 系统会自动生成 `sign_language_dataset.zip` 文件

### 数据采集最佳实践

✅ **推荐做法**：

- 每个单词至少 **60-100** 张图片
- 在 **3 种以上**不同光照环境下拍摄
- 手势与摄像头距离 **30-80cm**
- 手部占画面 **30-50%**
- 背景尽量简洁

❌ **避免**：

- 数据量少于 30 张
- 所有图片在同一环境拍摄
- 手势不一致或模糊
- 背景过于复杂

---

## 2️⃣ 模型训练

### 准备训练数据

1. **解压数据集**

   解压下载的 `sign_language_dataset.zip` 文件

2. **放置数据集**

   将解压后的 `sign_language_dataset` 文件夹放置到项目目录：

   ```
   c:\Users\86135\Desktop\my\sign_language_dataset\
   ```

3. **验证目录结构**

   确保目录结构如下：

   ```
   c:\Users\86135\Desktop\my\
   ├── sign_language_dataset/          # 训练数据集文件夹
   │   ├── hello/                      # 第1个单词
   │   │   ├── hello_1762259209912.jpg
   │   │   ├── hello_1762259209994.jpg
   │   │   ├── hello_1762259210084.jpg
   │   │   └── ... (至少 60 张)
   │   ├── thank/                      # 第2个单词
   │   │   ├── thank_1762259180296.jpg
   │   │   ├── thank_1762259180396.jpg
   │   │   └── ... (至少 60 张)
   │   ├── goodbye/                    # 第3个单词
   │   │   └── ... (至少 60 张)
   │   └── [其他单词]/
   │       └── ...
   ├── venv/                           # 虚拟环境文件夹
   ├── train_sign_language_model.py    # 训练脚本
   ├── translation_server.py           # 服务器脚本
   ├── requirements.txt                # 依赖列表
   └── ...
   ```

### 开始训练

#### 方法一：使用虚拟环境（推荐）

```powershell
# 1. 激活虚拟环境
.\venv\Scripts\Activate.ps1

# 2. 开始训练
python train_sign_language_model.py
```

#### 方法二：直接运行

```bash
python train_sign_language_model.py
```

### 训练过程说明

训练脚本会自动完成以下步骤：

```
============================================================
手语识别模型训练程序
============================================================

[1/5] 加载数据集...
      - 扫描 sign_language_dataset 文件夹
      - 加载所有图片
      - 提取手部关键点特征 (126维向量)
      数据集大小: 300 样本
      类别数: 5
      类别: ['hello', 'thank', 'goodbye', 'yes', 'no']

[2/5] 划分训练集和验证集...
      训练集: 240 样本 (80%)
      验证集: 60 样本 (20%)

[3/5] 构建神经网络模型...
      - 输入层: 126 维特征
      - 隐藏层: 256 → 512 → 256 → 128
      - 输出层: 5 类 (对应5个单词)
      - 总参数: 333,186 个

[4/5] 开始训练...
      - 最多 100 轮 (Epochs)
      - 自动早停 (Early Stopping)
      - 学习率自动调整

      Epoch 1/100: loss: 1.23 - accuracy: 0.45 - val_accuracy: 0.50
      Epoch 2/100: loss: 0.89 - accuracy: 0.67 - val_accuracy: 0.65
      ...
      Epoch 50/100: loss: 0.12 - accuracy: 0.98 - val_accuracy: 0.95

      ✅ 训练完成！验证集准确率达到 95%

[5/5] 保存模型...
      模型已保存到: sign_language_model.h5
      标签映射已保存到: sign_language_labels.json

============================================================
训练完成！
============================================================
```

### 训练完成后

训练完成后会生成两个重要文件：

- ✅ `sign_language_model.h5` - 训练好的神经网络模型（包含所有权重）
- ✅ `sign_language_labels.json` - 单词标签映射文件（类别索引对应关系）

**查看训练结果**：

```
验证集准确率: 95.00%
验证集损失: 0.1234

模型文件:
  - sign_language_model.h5
  - sign_language_labels.json

可以使用实时翻译页面进行测试！
```

---

## 3️⃣ 实时翻译

### 启动后端服务

#### 方法一：使用虚拟环境（推荐）

```powershell
# 1. 激活虚拟环境（如果还未激活）
.\venv\Scripts\Activate.ps1

# 2. 启动翻译服务器
python translation_server.py
```

#### 方法二：直接运行

```bash
python translation_server.py
```

### 服务器启动成功标志

看到以下输出表示启动成功：

```
============================================================
手语翻译服务器启动中...
============================================================

正在加载模型...
✅ 模型加载成功！
   - 类别数: 5
   - 类别: ['hello', 'thank', 'goodbye', 'yes', 'no']

服务器地址:
  - 实时翻译: http://127.0.0.1:5000/realtime_translation.html
  - 数据采集: http://127.0.0.1:5000/data_collection.html
============================================================

 * Serving Flask app 'translation_server'
 * Running on http://127.0.0.1:5000
 * Press CTRL+C to quit
```

### 访问翻译页面

在浏览器中打开：

```
http://127.0.0.1:5000/realtime_translation.html
```

### 使用翻译功能

1. **允许摄像头权限**

   - 浏览器会弹出权限请求
   - 点击 **"允许"** 授予摄像头访问权限

2. **开始翻译**

   - 点击 **"开始翻译"** 按钮
   - 摄像头画面会显示在页面上
   - 系统开始实时识别手语

3. **展示手语**

   - 对着摄像头做出训练过的手语动作
   - 系统会实时识别并显示结果
   - 查看置信度（百分比越高越准确）
   - 绿色高亮表示高置信度（>70%）

4. **查看翻译历史**
   - 页面底部显示最近的翻译记录
   - 包含时间戳和置信度信息
   - 可构建完整句子

### 页面功能说明

- 🎥 **开始翻译** - 启动实时识别
- ⏸️ **停止翻译** - 暂停识别
- 🗑️ **清空历史** - 清除翻译记录
- 👋 **切换手部显示** - 显示/隐藏手部关键点标记

---

## 常见问题

### ❓ Q1: 识别准确率很低怎么办？

**解决方案**：

1. **增加训练数据**

   ```
   每个单词至少 60-100 张图片
   目前数据量不足会导致过拟合
   ```

2. **提高数据多样性**

   ```
   ✅ 在不同光照环境下拍摄
   ✅ 多个角度 (正面、侧面、俯视、仰视)
   ✅ 不同距离 (30cm、50cm、80cm)
   ✅ 多人拍摄 (不同肤色、手型)
   ```

3. **确保手势一致性**

   ```
   ✅ 基本手势形状保持不变
   ✅ 只变换角度和位置
   ✅ 避免手势变形
   ```

4. **重新训练模型**
   ```bash
   python train_sign_language_model.py
   ```

---

### ❓ Q2: 无法检测到手部？

**检查清单**：

- [ ] 光线是否充足？
- [ ] 手是否在画面中央？
- [ ] 手部与摄像头距离是否合适 (30-80cm)？
- [ ] 背景是否简洁？
- [ ] 摄像头是否正常工作？

**解决方案**：

```
1. 增加环境光照
2. 调整手部位置到画面中央
3. 保持合适距离
4. 使用纯色背景（如白墙）
5. 检查摄像头驱动程序
```

---

### ❓ Q3: 服务器启动失败？

**检查命令**：

```powershell
# 1. 检查端口是否被占用
netstat -ano | findstr :5000

# 2. 检查模型文件是否存在
dir sign_language_model.h5
dir sign_language_labels.json

# 3. 检查 Python 版本
python --version

# 4. 检查依赖包
pip list

# 5. 重新安装依赖
pip install -r requirements.txt
```

**如果端口被占用**：

```powershell
# 方法1: 更换端口（修改 translation_server.py 最后一行）
app.run(host='0.0.0.0', port=8000, debug=True)

# 方法2: 终止占用进程
# 先找到进程ID (PID)
netstat -ano | findstr :5000
# 然后终止进程
taskkill /F /PID <进程ID>
```

---

### ❓ Q4: 训练时出现内存错误？

**错误信息示例**：

```
MemoryError: Unable to allocate array
ResourceExhaustedError: OOM when allocating tensor
```

**解决方案**：

1. **减少批次大小**

   ```python
   # 修改 train_sign_language_model.py
   # 找到 batch_size 参数，从32改为16或8
   model.fit(X_train, y_train, batch_size=8, ...)
   ```

2. **降低图片分辨率**

   ```python
   # 在预处理函数中添加
   image = cv2.resize(image, (320, 240))
   ```

3. **关闭其他程序**

   ```
   关闭浏览器、视频软件等占用内存的程序
   ```

4. **使用更简单的模型**
   ```python
   # 减少神经元数量
   Dense(128) 替换 Dense(256)
   Dense(256) 替换 Dense(512)
   ```

---

### ❓ Q5: 为什么准确率只有 50%？

**原因分析**：

```
验证集准确率: 50.00%
验证集损失: 0.6091

可能原因:
1. 数据量严重不足 (< 30张/类)
2. 只有2个类别，接近随机猜测
3. 数据多样性不足
4. 训练数据与测试数据差异太大
```

**50% 准确率 = 随机猜测**

- 2 个类别时，随机猜对概率就是 50%
- 说明模型没有学到有效特征

**解决方案**：

```bash
# 1. 每个单词至少采集 60 张图片
每类: 60-100 张

# 2. 增加类别数量
建议: 5-10 个不同单词

# 3. 提高数据多样性
- 不同人拍摄
- 不同环境
- 不同光照
- 不同角度

# 4. 重新训练
python train_sign_language_model.py
```

---

## 性能优化建议

### 🎯 提高识别准确率

#### 1. 数据层面优化

```
推荐配置:
- 每个单词: 60-100 张图片
- 总类别数: 5-10 个单词
- 总数据量: 300-1000 张图片
- 拍摄人数: 至少 2-3 人
- 环境变化: 3 种以上光照条件
```

#### 2. 拍摄技巧

```
最佳拍摄实践:
✅ 距离: 30-80cm
✅ 角度: 正面 ±15°范围内轻微变化
✅ 位置: 画面中央 ±20% 范围内移动
✅ 光照: 明亮、柔和、均匀
✅ 背景: 纯色、简洁、无杂物
✅ 手势: 清晰、标准、一致
```

#### 3. 模型优化

```python
# 增加训练轮数
epochs = 200  # 从100增加到200

# 使用数据增强
from tensorflow.keras.preprocessing.image import ImageDataGenerator
datagen = ImageDataGenerator(
    rotation_range=15,
    width_shift_range=0.1,
    height_shift_range=0.1,
    zoom_range=0.1,
    brightness_range=[0.8, 1.2]
)

# 调整学习率
optimizer = Adam(learning_rate=0.0001)  # 降低学习率
```

---

### ⚡ 提高识别速度

#### 1. 降低视频帧率

```javascript
// 在 realtime_translation.html 中修改
setInterval(() => {
  predictFrame();
}, 100); // 从 30ms 改为 100ms (10 FPS)
```

#### 2. 使用 GPU 加速

```bash
# 安装 GPU 版本 TensorFlow
pip uninstall tensorflow
pip install tensorflow-gpu==2.15.0

# 需要安装 CUDA 和 cuDNN
# NVIDIA GPU 用户可获得 10-100 倍加速
```

#### 3. 模型优化

```python
# 减少模型复杂度
model = Sequential([
    Dense(128, activation='relu'),  # 从256降到128
    BatchNormalization(),
    Dropout(0.3),
    Dense(64, activation='relu'),   # 从128降到64
    Dense(num_classes, activation='softmax')
])
```

---

### 📊 监控和调试

#### 查看模型详情

```bash
# 安装 TensorBoard
pip install tensorboard

# 启动 TensorBoard
tensorboard --logdir=./logs
```

#### 实时监控日志

```bash
# 服务器日志会显示:
127.0.0.1 - - [04/Nov/2025 20:36:11] "POST /api/predict HTTP/1.1" 200 -

# 200 表示成功
# 404 表示路径错误
# 500 表示服务器内部错误
```

---

## 🎉 快速启动命令

### 一键启动脚本（Windows）

创建 `start.bat` 文件：

```batch
@echo off
echo ============================================================
echo 手语翻译系统 - 快速启动
echo ============================================================
echo.

echo [1/2] 激活虚拟环境...
call venv\Scripts\activate.bat

echo [2/2] 启动翻译服务器...
python translation_server.py

pause
```

双击运行 `start.bat` 即可自动启动！

### 一键启动脚本（PowerShell）

创建 `start.ps1` 文件：

```powershell
Write-Host "============================================================" -ForegroundColor Cyan
Write-Host "手语翻译系统 - 快速启动" -ForegroundColor Cyan
Write-Host "============================================================" -ForegroundColor Cyan
Write-Host ""

Write-Host "[1/2] 激活虚拟环境..." -ForegroundColor Yellow
.\venv\Scripts\Activate.ps1

Write-Host "[2/2] 启动翻译服务器..." -ForegroundColor Yellow
python translation_server.py
```

右键运行 `start.ps1`！

---

## 📞 技术支持

如有问题，请查看：

- 📖 [README.md](README.md) - 项目详细文档
- 🔧 [model_evaluation_guide.md](model_evaluation_guide.md) - 技术原理详解
- 💡 项目 Issues - 问题反馈和讨论

---

## 🚀 立即开始

现在您已经了解了所有步骤，开始创建您自己的手语翻译系统吧！

```powershell
# 快速启动命令
.\venv\Scripts\Activate.ps1
python translation_server.py
```

然后访问：**http://127.0.0.1:5000/realtime_translation.html**

**祝您使用愉快！** 🤟✨

---

<div align="center">

**Made with ❤️ for Sign Language Recognition**

_让科技连接无声的世界_

</div>
